<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    .avatars img {
      width: 80px;
      margin: 6px;
      cursor: pointer;
      border: 3px solid transparent;
      border-radius: 10px;
    }
    .avatars img.selected {
      border-color: #2ecc71;
    }
  </style>
</head>
<body>

<h2>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞</h2>

<div id="join">
  <input id="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" />

  <p>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä:</p>

  <div class="avatars" id="avatars"></div>

  <br>
  <button onclick="joinGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
</div>

<p id="status"></p>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

let selectedAvatar = null;
const status = document.getElementById('status');
const joinBlock = document.getElementById('join');
const avatarsDiv = document.getElementById('avatars');

/* ====== –ê–í–ê–¢–ê–†–´ 1‚Äì8 ====== */
for (let i = 1; i <= 8; i++) {
  const img = document.createElement('img');
  img.src = `/images/avatars/solo/avatar${i}.png`;
  img.onclick = () => selectAvatar(img, `avatar${i}`);
  avatarsDiv.appendChild(img);
}

function selectAvatar(img, avatarName) {
  document
    .querySelectorAll('.avatars img')
    .forEach(el => el.classList.remove('selected'));

  img.classList.add('selected');
  selectedAvatar = avatarName;
  status.textContent = '–í—ã–±—Ä–∞–Ω –∞–≤–∞—Ç–∞—Ä: ' + avatarName;
}

function joinGame() {
  const name = document.getElementById('name').value.trim();

  if (!name || !selectedAvatar) {
    alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä');
    return;
  }

  socket.emit('register_player', {
    name,
    avatar: selectedAvatar
  });

  joinBlock.style.display = 'none';
  status.textContent = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã...';
}

socket.on('game_started', () => {
  status.textContent = 'üéâ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å. –û–∂–∏–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å.';
});
</script>

</body>
</html>
